ENVIRONMENT=development
LAUNCH_MODE=false
DATABASE_URL=postgresql://postgres:postgres@db:5432/apishield
SECRET_KEY=super-secret-key
# Optional tuning parameters
FAIL_LIMIT=5
FAIL_WINDOW_SECONDS=60
DB_ECHO=true
ACCESS_TOKEN_EXPIRE_MINUTES=15
SUPPORT_VIEW_TOKEN_TTL_MINUTES=10
REGISTER_WITH_DEMOSHOP=true
LOGIN_WITH_DEMOSHOP=true
DEMO_SHOP_URL=http://127.0.0.1:3005
DEMO_DATA_RETENTION_DAYS=7
EMAILS_ENABLED=true
ONBOARDING_NO_EVENTS_HOURS=2
AFFILIATE_REFUND_WINDOW_DAYS=14
ANOMALY_DETECTION=true
REAUTH_PER_REQUEST=false
ZERO_TRUST_API_KEY=

# Tenancy settings
TENANT_HEADER_NAME=X-Tenant-ID
REQUIRE_TENANT_HEADER=true
DEFAULT_TENANT_SLUG=
ALLOW_MULTI_TENANT_DEV_BYPASS=false
TENANT_STRICT_404=true
TENANT_CONTEXT_RESOLUTION_ORDER=["header","jwt","default"]
INVITE_TOKEN_TTL_HOURS=72
INVITE_TOKEN_RETURN_IN_RESPONSE=false
AUDIT_WS_REQUIRE_TENANT=true
API_KEY_SECRET_RETURN_IN_RESPONSE=false
AGENT_URL=https://cdn.yourapp.com/agent.js
BADGE_SIGNATURE_TTL_SECONDS=300
BADGE_JS_CACHE_SECONDS=60
BADGE_DATA_CACHE_SECONDS=60

# Public trust score proof (Ed25519 base64url-encoded 32-byte keys)
TRUST_SCORE_SIGNING_PRIVATE_KEY=
TRUST_SCORE_SIGNING_PUBLIC_KEY=
TRUST_SCORE_SIGNING_KEY_ID=score-key-1
TRUST_SCORE_CACHE_SECONDS=60
TRUST_SCORE_RPM=120
TRUST_SCORE_BURST=240
TRUST_SCORE_ABUSE_THRESHOLD=20
TRUST_SCORE_BAN_SECONDS=600

# Performance profiling
PERF_PROFILING=false
PERF_SLOW_QUERY_MS=200
PERF_SLOW_QUERY_MAX_PER_REQUEST=5

# Cache settings
CACHE_BACKEND=memory
CACHE_NAMESPACE=apishield
CACHE_DEFAULT_TTL_SECONDS=60
CACHE_TTL_MAP_SUMMARY=60
CACHE_TTL_MAP_DRILLDOWN=60
CACHE_TTL_REVENUE_LEAKS=60
CACHE_TTL_TRUST_SNAPSHOTS=60
CACHE_TTL_PORTFOLIO_SUMMARY=60
CACHE_TTL_INCIDENTS_LIST=30
CACHE_TTL_INCIDENT_DETAIL=30
REDIS_URL=

# External integrations
INTEGRATION_ENCRYPTION_KEY=

# SSO / OIDC settings
FRONTEND_BASE_URL=http://localhost:3000
SSO_STATE_TTL_SECONDS=600
SSO_DISCOVERY_TIMEOUT_SECONDS=5
SSO_TOKEN_TIMEOUT_SECONDS=5
SSO_DISCOVERY_CACHE_SECONDS=300

# Geo enrichment
# Provider selection: local or api
GEO_PROVIDER=local
GEO_DB_PATH=/data/geo/GeoLite2-City.mmdb
GEO_ASN_DB_PATH=/data/geo/GeoLite2-ASN.mmdb
GEO_API_KEY=
GEO_API_BASE_URL=
GEO_ENRICHMENT_TTL_DAYS=30

# Proxy-aware client IP extraction
TRUST_PROXY_HEADERS=false
# JSON list of trusted proxy IPs or CIDRs
TRUSTED_PROXY_IPS=["127.0.0.1","10.0.0.0/8"]
# JSON list of headers to trust when proxy headers are enabled
TRUSTED_IP_HEADERS=["CF-Connecting-IP","X-Forwarded-For","X-Real-IP"]

# Security analytics endpoints
ALLOW_RAW_IP_SECURITY_ENDPOINTS=false

# Security headers (CSP/HSTS/etc.)
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
HSTS_PRELOAD=false
X_FRAME_OPTIONS=DENY
REFERRER_POLICY=strict-origin-when-cross-origin
CSP_DEFAULT=default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; form-action 'self'; img-src 'self' data:; script-src 'self'; style-src 'self' 'unsafe-inline'; connect-src 'self'

# Ingestion rate limiting + abuse protection
INGEST_DEFAULT_RPM=120
INGEST_DEFAULT_BURST=120
INGEST_IP_RPM=300
INGEST_IP_BURST=300
INGEST_MAX_BODY_BYTES=65536
INGEST_INVALID_BAN_THRESHOLD=20
INGEST_INVALID_WINDOW_SECONDS=60
INGEST_BAN_SECONDS=600
INGEST_SECURITY_DEFAULT_RPM=60
INGEST_SECURITY_DEFAULT_BURST=60
INGEST_SECURITY_IP_RPM=120
INGEST_SECURITY_IP_BURST=120
INGEST_ABUSE_BAN_THRESHOLD=10
INGEST_ABUSE_WINDOW_SECONDS=60
INGEST_ABUSE_BAN_SECONDS=900
INGEST_MAX_BATCH_EVENTS=50
INGEST_SAMPLING_DEFAULT_RATE=1.0

# Data exports (warehouse connectors)
EXPORT_TARGET=local
EXPORT_LOCAL_DIR=./exports
EXPORT_DEFAULT_LOOKBACK_HOURS=24

# Job queue settings (worker partitions + fairness)
JOB_QUEUE_LOCK_TIMEOUT_SECONDS=300
JOB_QUEUE_POLL_INTERVAL_SECONDS=2
QUEUE_TENANT_RPM_STANDARD=60
QUEUE_TENANT_BURST_STANDARD=5
QUEUE_TENANT_MAX_IN_FLIGHT_STANDARD=1
QUEUE_TENANT_RPM_BULK=10
QUEUE_TENANT_BURST_BULK=2
QUEUE_TENANT_MAX_IN_FLIGHT_BULK=1

# Multi-region readiness (data residency)
DEFAULT_TENANT_REGION=us
# JSON maps for future routing; keys: region codes (e.g., us, eu)
REGION_DB_URLS={"us":"postgresql://postgres:postgres@db:5432/apishield"}
REGION_EXPORT_TARGETS={"us":"local"}
# Optional: where to store platform-level audit logs (tenant id)
PLATFORM_AUDIT_TENANT_ID=
