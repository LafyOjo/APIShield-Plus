DATABASE_URL=postgresql://postgres:postgres@db:5432/apishield
SECRET_KEY=super-secret-key
# Optional tuning parameters
FAIL_LIMIT=5
FAIL_WINDOW_SECONDS=60
DB_ECHO=true
ACCESS_TOKEN_EXPIRE_MINUTES=30
REGISTER_WITH_DEMOSHOP=true
LOGIN_WITH_DEMOSHOP=true
DEMO_SHOP_URL=http://127.0.0.1:3005
ANOMALY_DETECTION=true
REAUTH_PER_REQUEST=false
ZERO_TRUST_API_KEY=demo-key

# Tenancy settings
TENANT_HEADER_NAME=X-Tenant-ID
REQUIRE_TENANT_HEADER=true
DEFAULT_TENANT_SLUG=
ALLOW_MULTI_TENANT_DEV_BYPASS=false
TENANT_STRICT_404=true
TENANT_CONTEXT_RESOLUTION_ORDER=["header","jwt","default"]
INVITE_TOKEN_TTL_HOURS=72
INVITE_TOKEN_RETURN_IN_RESPONSE=false
AUDIT_WS_REQUIRE_TENANT=true
API_KEY_SECRET_RETURN_IN_RESPONSE=false
AGENT_URL=https://cdn.yourapp.com/agent.js

# External integrations
INTEGRATION_ENCRYPTION_KEY=

# Geo enrichment
# Provider selection: local or api
GEO_PROVIDER=local
GEO_DB_PATH=/data/geo/GeoLite2-City.mmdb
GEO_ASN_DB_PATH=/data/geo/GeoLite2-ASN.mmdb
GEO_API_KEY=
GEO_API_BASE_URL=
GEO_ENRICHMENT_TTL_DAYS=30

# Proxy-aware client IP extraction
TRUST_PROXY_HEADERS=false
# JSON list of trusted proxy IPs or CIDRs
TRUSTED_PROXY_IPS=["127.0.0.1","10.0.0.0/8"]
# JSON list of headers to trust when proxy headers are enabled
TRUSTED_IP_HEADERS=["CF-Connecting-IP","X-Forwarded-For","X-Real-IP"]

# Security analytics endpoints
ALLOW_RAW_IP_SECURITY_ENDPOINTS=false

# Ingestion rate limiting + abuse protection
INGEST_DEFAULT_RPM=120
INGEST_DEFAULT_BURST=120
INGEST_IP_RPM=300
INGEST_IP_BURST=300
INGEST_MAX_BODY_BYTES=65536
INGEST_INVALID_BAN_THRESHOLD=20
INGEST_INVALID_WINDOW_SECONDS=60
INGEST_BAN_SECONDS=600
